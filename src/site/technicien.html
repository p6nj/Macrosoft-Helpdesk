<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Macrosoft HelpDesk</title>
    <link rel="stylesheet" type="text/css" href="common.css">
</head>

<script>
    function confirm(at, tid) {
        let dialog = document.getElementById('confirm');
        let form = document.forms['options'];
        if (at) {
            [...dialog.getElementsByClassName('at')].forEach(e => { e.style.display = 'inline'; });
            [...dialog.getElementsByClassName('na')].forEach(e => { e.style.display = 'none'; });
        } else {
            [...dialog.getElementsByClassName('na')].forEach(e => { e.style.display = 'inline'; });
            [...dialog.getElementsByClassName('at')].forEach(e => { e.style.display = 'none'; });
        }
        form.elements['idT'].value = tid;
        dialog.showModal();
    }
</script>

<body>
    <header>
        <nav>
            <div class="left">
                <img id="logo" src="img/logo.svg" alt="Logo Macrosoft Helpdesk">
                <h1>HelpDesk</h1>
            </div>
            <div class="far-right">
                <button
                    onclick="window.location.href='connexion.php?déco=1&message=Vous avez été déconnecté.';">Deconnexion</button>
                <button title="<?= $_SESSION['client']->getProfil()['login']; ?>"
                    onclick="document.querySelector(' dialog#profil').showModal()">
                    Profil
                </button>
                <dialog id="profil">
                    <h2>Profil</h2>
                    <?php $profil = $_SESSION['client']->getProfil(); ?>
                    Login :
                    <?= $profil['login'] ?><br>
                    Mot de passe : <hidden id='mdp'>
                        <?= $profil['mdp'] ?>
                    </hidden>
                    <button
                        onclick="document.getElementById('mdp').style.display='block'; document.getElementById('affiche-mdp').style.display='none'"
                        id="affiche-mdp">Afficher le mot de passe</button>
                    <br>
                    <button
                        onclick="event.target.parentElement.close(); document.getElementById('mdp').style.display='none'; document.getElementById('affiche-mdp').style.display='block';">Fermer</button>
                </dialog>
            </div>
        </nav>
    </header>
    <main id="header-top-margin">
        <div class="message">
        </div>
        <div class="error">
        </div>
        <div>
            <h1>Tickets Attribués</h1>
            <div id="ticket-container">
                <ticket onclick="confirm(true, 1)" class="clickable">
                    <lib>Libellé</lib>
                    <niv>Urgent</niv>
                    <p>Description</p>
                    <cible>breval</cible>
                    <demandeur>william</demandeur>
                </ticket>
            </div>
        </div>
        <div>
            <h1>Tickets Non Attribués</h1>
            <div id="ticket-container">
                <ticket onclick="confirm(false, 2)" class="clickable">
                    <lib>Libellé</lib>
                    <niv>Urgent</niv>
                    <p>Description</p>
                    <cible>breval</cible>
                    <demandeur>william</demandeur>
                </ticket>
            </div>
        </div>
        <dialog id="confirm">
            <h2>Confirmation</h2>
            <p class="na">Voulez-vous prendre en charge ce ticket ?</p>
            <p class="at">Voulez-vous fermer ce ticket ?</p>
            <br><br>
            <form method="form" id="options">
                <input type="hidden" name="idT">
                <button type="submit" name="na" class="na">Confirmer</button>
                <button type="submit" name="at" class="at">Confirmer</button>
                <input type="button" onclick="document.getElementById('confirm').close()" value="Annuler">
            </form>
        </dialog>
    </main>
    <footer>
        <p>&copy; 2023 Macrosoft Helpdesk</p>
    </footer>
</body>

</html>